const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/HomePage-BNhsWKnH.js","assets/chunks/ui-BN6vDYCP.js","assets/chunks/vendor-PtCq8RB_.js","assets/chunks/utils-CK2oMmzc.js","assets/chunks/SignUpPage-btrzB8MX.js","assets/chunks/AuthImagePattern-DcSfM4TZ.js","assets/chunks/LoginPage-7gxkun4r.js","assets/chunks/SettingsPage-Ygl5ZG-S.js","assets/chunks/ProfilePage-Du4xbKU5.js"])))=>i.map(i=>d[i]);
import{r as e,a as s,L as t,b as n,c as r,N as a,B as o}from"./chunks/vendor-PtCq8RB_.js";import{a as c,c as i,l}from"./chunks/utils-CK2oMmzc.js";import{_ as u,M as d,S as h,U as m,L as p,I as f,a as g}from"./chunks/ui-BN6vDYCP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)})).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var x={exports:{}},j={},y=e,_=Symbol.for("react.element"),k=Symbol.for("react.fragment"),v=Object.prototype.hasOwnProperty,S=y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function N(e,s,t){var n,r={},a=null,o=null;for(n in void 0!==t&&(a=""+t),void 0!==s.key&&(a=""+s.key),void 0!==s.ref&&(o=s.ref),s)v.call(s,n)&&!b.hasOwnProperty(n)&&(r[n]=s[n]);if(e&&e.defaultProps)for(n in s=e.defaultProps)void 0===r[n]&&(r[n]=s[n]);return{$$typeof:_,type:e,key:a,ref:o,props:r,_owner:S.current}}j.Fragment=k,j.jsx=N,j.jsxs=N,x.exports=j;var P,E=x.exports,U=s;P=U.createRoot,U.hydrateRoot;const L={},w=function(e,s,t){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),t=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));n=Promise.allSettled(s.map((e=>{if((e=function(e){return"/"+e}(e))in L)return;L[e]=!0;const s=e.endsWith(".css"),n=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=s?"stylesheet":"modulepreload",s||(r.as="script"),r.crossOrigin="",r.href=e,t&&r.setAttribute("nonce",t),document.head.appendChild(r),s?new Promise(((s,t)=>{r.addEventListener("load",s),r.addEventListener("error",(()=>t(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function r(e){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=e,window.dispatchEvent(s),!s.defaultPrevented)throw e}return n.then((s=>{for(const e of s||[])"rejected"===e.status&&r(e.reason);return e().catch(r)}))},O=c.create({baseURL:"/api",withCredentials:!0}),I=i(((e,s)=>({authUser:null,isSigningUp:!1,isLoggingIn:!1,isUpdatingProfile:!1,isCheckingAuth:!0,onlineUsers:[],socket:null,checkAuth:async()=>{try{const t=await O.get("/auth/check");e({authUser:t.data}),s().connectSocket()}catch(t){e({authUser:null})}finally{e({isCheckingAuth:!1})}},signup:async t=>{e({isSigningUp:!0});try{const n=await O.post("/auth/signup",t);e({authUser:n.data}),u.success("Account created successfully"),s().connectSocket()}catch(n){u.error(n.response.data.message)}finally{e({isSigningUp:!1})}},login:async t=>{e({isLoggingIn:!0});try{const n=await O.post("/auth/login",t);e({authUser:n.data}),u.success("Logged in successfully"),s().connectSocket()}catch(n){u.error(n.response.data.message)}finally{e({isLoggingIn:!1})}},logout:async()=>{try{await O.post("/auth/logout"),e({authUser:null}),u.success("Logged out successfully"),s().disconnectSocket()}catch(t){u.error(t.response.data.message)}},updateProfile:async t=>{e({isUpdatingProfile:!0});try{const n=await O.put("/auth/update-profile",t);e({authUser:n.data}),u.success("Profile updated successfully"),t.username&&s().reconnectSocket()}catch(n){u.error(n.response.data.message)}finally{e({isUpdatingProfile:!1})}},connectSocket:()=>{var t;const{authUser:n}=s();if(!n||(null==(t=s().socket)?void 0:t.connected))return;const r=l("/",{query:{userId:n._id,username:n.username||n.fullName},withCredentials:!0});r.connect(),e({socket:r}),r.on("getOnlineUsers",(s=>{e({onlineUsers:s})}))},reconnectSocket:()=>{s().disconnectSocket(),s().connectSocket()},disconnectSocket:()=>{var t;(null==(t=s().socket)?void 0:t.connected)&&s().socket.disconnect(),e({socket:null})}}))),A=()=>{const{logout:e,authUser:s}=I();return E.jsx("header",{className:"bg-base-100 border-b border-base-300 fixed w-full top-0 z-40 \r\n    backdrop-blur-lg bg-base-100/80",children:E.jsx("div",{className:"container mx-auto px-4 h-16",children:E.jsxs("div",{className:"flex items-center justify-between h-full",children:[E.jsx("div",{className:"flex items-center gap-8",children:E.jsxs(t,{to:"/",className:"flex items-center gap-2.5 hover:opacity-80 transition-all",children:[E.jsx("div",{className:"size-9 rounded-lg bg-primary/10 flex items-center justify-center",children:E.jsx(d,{className:"w-5 h-5 text-primary"})}),E.jsx("h1",{className:"text-lg font-bold",children:"Chatty"})]})}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsxs(t,{to:"/settings",className:"\n              btn btn-sm gap-2 transition-colors\n              \n              ",children:[E.jsx(h,{className:"w-4 h-4"}),E.jsx("span",{className:"hidden sm:inline",children:"Settings"})]}),s&&E.jsxs(E.Fragment,{children:[E.jsxs(t,{to:"/profile",className:"btn btn-sm gap-2",children:[E.jsx(m,{className:"size-5"}),E.jsx("span",{className:"hidden sm:inline",children:"Profile"})]}),E.jsxs("button",{className:"flex gap-2 items-center",onClick:e,children:[E.jsx(p,{className:"size-5"}),E.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})]})})})},R=i((e=>({theme:localStorage.getItem("chat-theme")||"coffee",setTheme:s=>{localStorage.setItem("chat-theme",s),e({theme:s})}}))),z=e.lazy((()=>w((()=>import("./chunks/HomePage-BNhsWKnH.js")),__vite__mapDeps([0,1,2,3])))),C=e.lazy((()=>w((()=>import("./chunks/SignUpPage-btrzB8MX.js")),__vite__mapDeps([4,2,5,1,3])))),T=e.lazy((()=>w((()=>import("./chunks/LoginPage-7gxkun4r.js")),__vite__mapDeps([6,2,5,1,3])))),D=e.lazy((()=>w((()=>import("./chunks/SettingsPage-Ygl5ZG-S.js")),__vite__mapDeps([7,2,1,3])))),V=e.lazy((()=>w((()=>import("./chunks/ProfilePage-Du4xbKU5.js")),__vite__mapDeps([8,2,1,3])))),$=()=>E.jsx("div",{className:"flex items-center justify-center h-screen",children:E.jsx(g,{className:"size-10 animate-spin"})}),q=()=>{const{authUser:s,checkAuth:t,isCheckingAuth:o}=I(),{theme:c}=R();return e.useEffect((()=>{t()}),[t]),o&&!s?E.jsx($,{}):E.jsxs("div",{"data-theme":c,children:[E.jsx(A,{}),E.jsx(e.Suspense,{fallback:E.jsx($,{}),children:E.jsxs(n,{children:[E.jsx(r,{path:"/",element:s?E.jsx(z,{}):E.jsx(a,{to:"/login"})}),E.jsx(r,{path:"/signup",element:s?E.jsx(a,{to:"/"}):E.jsx(C,{})}),E.jsx(r,{path:"/login",element:s?E.jsx(a,{to:"/"}):E.jsx(T,{})}),E.jsx(r,{path:"/settings",element:E.jsx(D,{})}),E.jsx(r,{path:"/profile",element:s?E.jsx(V,{}):E.jsx(a,{to:"/login"})})]})}),E.jsx(f,{position:"top-center",toastOptions:{duration:3e3,style:{maxWidth:"90vw",padding:"8px 16px",fontSize:"14px"}}})]})};P(document.getElementById("root")).render(E.jsx(e.StrictMode,{children:E.jsx(o,{future:{v7_relativeSplatPath:!0},children:E.jsx(q,{})})}));export{O as a,R as b,E as j,I as u};
